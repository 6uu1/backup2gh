<!DOCTYPE html>
<html lang="en">
  <head>
    <script src="https://getbootstrap.com/docs/5.3/assets/js/color-modes.js"></script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="" />
    <title><<.title>></title>
    <link rel="shortcut icon" href="<<.base_path>>/fs/static/logo.svg" />
    <link
      href="https://unpkg.shop.jd.com/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      rel="stylesheet" />
    <script src="https://unpkg.shop.jd.com/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.shop.jd.com/vue@3.4.33/dist/vue.global.prod.js"></script>
    <link
      href="https://unpkg.shop.jd.com/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
      rel="stylesheet" />
    <style>
      .list-group {
        width: 100%;
        max-width: 460px;
        margin-inline: 1.5rem;
      }

      .form-check-input:checked + .form-checked-content {
        opacity: 0.5;
      }

      .form-check-input-placeholder {
        border-style: dashed;
      }
      [contenteditable]:focus {
        outline: 0;
      }

      .list-group-checkable .list-group-item {
        cursor: pointer;
      }
      .list-group-item-check {
        position: absolute;
        clip: rect(0, 0, 0, 0);
      }
      .list-group-item-check:hover + .list-group-item {
        background-color: var(--bs-secondary-bg);
      }
      .list-group-item-check:checked + .list-group-item {
        color: #fff;
        background-color: var(--bs-primary);
        border-color: var(--bs-primary);
      }
      .list-group-item-check[disabled] + .list-group-item,
      .list-group-item-check:disabled + .list-group-item {
        pointer-events: none;
        filter: none;
        opacity: 0.5;
      }

      .list-group-radio .list-group-item {
        cursor: pointer;
        border-radius: 0.5rem;
      }
      .list-group-radio .form-check-input {
        z-index: 2;
        margin-top: -0.5em;
      }
      .list-group-radio .list-group-item:hover,
      .list-group-radio .list-group-item:focus {
        background-color: var(--bs-secondary-bg);
      }

      .list-group-radio .form-check-input:checked + .list-group-item {
        background-color: var(--bs-body);
        border-color: var(--bs-primary);
        box-shadow: 0 0 0 2px var(--bs-primary);
      }
      .list-group-radio .form-check-input[disabled] + .list-group-item,
      .list-group-radio .form-check-input:disabled + .list-group-item {
        pointer-events: none;
        filter: none;
        opacity: 0.5;
      }

      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }

      .b-example-divider {
        width: 100%;
        height: 3rem;
        background-color: rgba(0, 0, 0, 0.1);
        border: solid rgba(0, 0, 0, 0.15);
        border-width: 1px 0;
        box-shadow: inset 0 0.5em 1.5em rgba(0, 0, 0, 0.1),
          inset 0 0.125em 0.5em rgba(0, 0, 0, 0.15);
      }

      .b-example-vr {
        flex-shrink: 0;
        width: 1.5rem;
        height: 100vh;
      }

      .bi {
        vertical-align: -0.125em;
        fill: currentColor;
      }

      .nav-scroller {
        position: relative;
        z-index: 2;
        height: 2.75rem;
        overflow-y: hidden;
      }

      .nav-scroller .nav {
        display: flex;
        flex-wrap: nowrap;
        padding-bottom: 1rem;
        margin-top: -1px;
        overflow-x: auto;
        text-align: center;
        white-space: nowrap;
        -webkit-overflow-scrolling: touch;
      }
      .bd-mode-toggle {
        z-index: 1500;
      }
      .bd-mode-toggle .dropdown-menu .active .bi {
        display: block !important;
      }
    </style>
  </head>
  <body>
    <div id="app">
      <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
        <symbol id="check2" viewBox="0 0 16 16">
          <path
            d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z" />
        </symbol>
        <symbol id="circle-half" viewBox="0 0 16 16">
          <path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z" />
        </symbol>
        <symbol id="moon-stars-fill" viewBox="0 0 16 16">
          <path
            d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z" />
          <path
            d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z" />
        </symbol>
        <symbol id="sun-fill" viewBox="0 0 16 16">
          <path
            d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z" />
        </symbol>
      </svg>
      <div class="container">
        <div class="row d-flex align-items-center" style="height: 95vh">
          <div class="col-md-10 offset-md-1 align-self-center">
            <h3 class="mb-4 text-center">
              <img
                id="logo-svg"
                src="<<.base_path>>/fs/static/logo.svg"
                style="
                  width: 1.5em;
                  margin-right: 0.1em;
                  vertical-align: bottom;
                " />备份到GitHub
            </h3>
            <div class="card">
              <div class="card-body">
                <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                  <li class="nav-item" role="presentation">
                    <button
                      class="nav-link active"
                      id="pills-home-tab"
                      data-bs-toggle="pill"
                      data-bs-target="#pills-home"
                      type="button"
                      role="tab"
                      aria-controls="pills-home"
                      aria-selected="true">
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="16"
                        height="16"
                        fill="currentColor"
                        class="bi bi-file-earmark-zip"
                        viewBox="0 0 16 16">
                        <path
                          d="M5 7.5a1 1 0 0 1 1-1h1a1 1 0 0 1 1 1v.938l.4 1.599a1 1 0 0 1-.416 1.074l-.93.62a1 1 0 0 1-1.11 0l-.929-.62a1 1 0 0 1-.415-1.074L5 8.438zm2 0H6v.938a1 1 0 0 1-.03.243l-.4 1.598.93.62.929-.62-.4-1.598A1 1 0 0 1 7 8.438z" />
                        <path
                          d="M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1h-2v1h-1v1h1v1h-1v1h1v1H6V5H5V4h1V3H5V2h1V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5z" />
                      </svg>
                      备份
                    </button>
                  </li>
                  <li class="nav-item" role="presentation">
                    <button
                      class="nav-link"
                      id="pills-profile-tab"
                      data-bs-toggle="pill"
                      data-bs-target="#pills-profile"
                      type="button"
                      role="tab"
                      aria-controls="pills-profile"
                      aria-selected="false">
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="16"
                        height="16"
                        fill="currentColor"
                        class="bi bi-gear-wide-connected"
                        viewBox="0 0 16 16">
                        <path
                          d="M7.068.727c.243-.97 1.62-.97 1.864 0l.071.286a.96.96 0 0 0 1.622.434l.205-.211c.695-.719 1.888-.03 1.613.931l-.08.284a.96.96 0 0 0 1.187 1.187l.283-.081c.96-.275 1.65.918.931 1.613l-.211.205a.96.96 0 0 0 .434 1.622l.286.071c.97.243.97 1.62 0 1.864l-.286.071a.96.96 0 0 0-.434 1.622l.211.205c.719.695.03 1.888-.931 1.613l-.284-.08a.96.96 0 0 0-1.187 1.187l.081.283c.275.96-.918 1.65-1.613.931l-.205-.211a.96.96 0 0 0-1.622.434l-.071.286c-.243.97-1.62.97-1.864 0l-.071-.286a.96.96 0 0 0-1.622-.434l-.205.211c-.695.719-1.888.03-1.613-.931l.08-.284a.96.96 0 0 0-1.186-1.187l-.284.081c-.96.275-1.65-.918-.931-1.613l.211-.205a.96.96 0 0 0-.434-1.622l-.286-.071c-.97-.243-.97-1.62 0-1.864l.286-.071a.96.96 0 0 0 .434-1.622l-.211-.205c-.719-.695-.03-1.888.931-1.613l.284.08a.96.96 0 0 0 1.187-1.186l-.081-.284c-.275-.96.918-1.65 1.613-.931l.205.211a.96.96 0 0 0 1.622-.434zM12.973 8.5H8.25l-2.834 3.779A4.998 4.998 0 0 0 12.973 8.5m0-1a4.998 4.998 0 0 0-7.557-3.779l2.834 3.78zM5.048 3.967l-.087.065zm-.431.355A4.98 4.98 0 0 0 3.002 8c0 1.455.622 2.765 1.615 3.678L7.375 8zm.344 7.646.087.065z" />
                      </svg>
                      配置
                    </button>
                  </li>
                </ul>
                <div class="tab-content" id="pills-tabContent">
                  <div class="toast-container position-fixed top-0 end-0 p-3">
                    <div
                      id="liveToast"
                      class="toast align-items-center"
                      role="alert"
                      aria-live="assertive"
                      aria-atomic="true">
                      <div class="d-flex justify-content-center">
                        <div class="toast-body" id="msgId"></div>
                      </div>
                    </div>
                  </div>
                  <div
                    class="tab-pane fade show active"
                    id="pills-home"
                    role="tabpanel"
                    aria-labelledby="pills-home-tab"
                    tabindex="0">
                    <div class="row">
                      <div class="col align-self-end">
                        <div class="dropdown float-end bd-mode-toggle">
                          <button
                            class="btn btn-secondary py-2 dropdown-toggle d-flex align-items-center rounded"
                            id="bd-theme"
                            type="button"
                            aria-expanded="false"
                            data-bs-toggle="dropdown"
                            aria-label="Toggle theme (light)">
                            <svg
                              class="bi my-1 theme-icon-active"
                              width="1em"
                              height="1em">
                              <use href="#sun-fill"></use>
                            </svg>
                            <span class="visually-hidden" id="bd-theme-text"
                              >Toggle theme</span
                            >
                          </button>
                          <ul
                            class="dropdown-menu dropdown-menu-end shadow"
                            aria-labelledby="bd-theme-text">
                            <li>
                              <button
                                type="button"
                                class="dropdown-item d-flex align-items-center active"
                                data-bs-theme-value="light"
                                aria-pressed="true">
                                <svg
                                  class="bi me-2 opacity-50"
                                  width="1em"
                                  height="1em">
                                  <use href="#sun-fill"></use>
                                </svg>
                                Light
                                <svg
                                  class="bi ms-auto d-none"
                                  width="1em"
                                  height="1em">
                                  <use href="#check2"></use>
                                </svg>
                              </button>
                            </li>
                            <li>
                              <button
                                type="button"
                                class="dropdown-item d-flex align-items-center"
                                data-bs-theme-value="dark"
                                aria-pressed="false">
                                <svg
                                  class="bi me-2 opacity-50"
                                  width="1em"
                                  height="1em">
                                  <use href="#moon-stars-fill"></use>
                                </svg>
                                Dark
                                <svg
                                  class="bi ms-auto d-none"
                                  width="1em"
                                  height="1em">
                                  <use href="#check2"></use>
                                </svg>
                              </button>
                            </li>
                            <li>
                              <button
                                type="button"
                                class="dropdown-item d-flex align-items-center"
                                data-bs-theme-value="auto"
                                aria-pressed="false">
                                <svg
                                  class="bi me-2 opacity-50"
                                  width="1em"
                                  height="1em">
                                  <use href="#circle-half"></use>
                                </svg>
                                Auto
                                <svg
                                  class="bi ms-auto d-none"
                                  width="1em"
                                  height="1em">
                                  <use href="#check2"></use>
                                </svg>
                              </button>
                            </li>
                          </ul>
                        </div>
                        <button
                          class="btn btn-outline-danger float-end py-2 align-items-center me-2 rounded"
                          type="button"
                          @click="deleteBackup">
                          <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="16"
                            height="16"
                            fill="currentColor"
                            class="bi bi-archive"
                            viewBox="0 0 16 16">
                            <path
                              d="M0 2a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1v7.5a2.5 2.5 0 0 1-2.5 2.5h-9A2.5 2.5 0 0 1 1 12.5V5a1 1 0 0 1-1-1zm2 3v7.5A1.5 1.5 0 0 0 3.5 14h9a1.5 1.5 0 0 0 1.5-1.5V5zm13-3H1v2h14zM5 7.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5" />
                          </svg>
                          删除
                        </button>
                        <button
                          class="btn btn-outline-primary float-end py-2 align-items-center me-2 rounded"
                          type="button"
                          @click="restoreBackup">
                          <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="16"
                            height="16"
                            fill="currentColor"
                            class="bi bi-layer-backward"
                            viewBox="0 0 16 16">
                            <path
                              d="M8.354 15.854a.5.5 0 0 1-.708 0l-3-3a.5.5 0 0 1 0-.708l1-1a.5.5 0 0 1 .708 0l.646.647V4H1a1 1 0 0 1-1-1V1a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H9v7.793l.646-.647a.5.5 0 0 1 .708 0l1 1a.5.5 0 0 1 0 .708z" />
                            <path
                              d="M1 9a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1h4.5a.5.5 0 0 1 0 1H1v2h4.5a.5.5 0 0 1 0 1zm9.5 0a.5.5 0 0 1 0-1H15V6h-4.5a.5.5 0 0 1 0-1H15a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1z" />
                          </svg>
                          还原备份
                        </button>
                        <button
                          class="btn btn-outline-success float-end py-2 align-items-center me-2 rounded"
                          type="button"
                          @click="runBackup">
                          <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="16"
                            height="16"
                            fill="currentColor"
                            class="bi bi-layer-forward"
                            viewBox="0 0 16 16">
                            <path
                              d="M8.354.146a.5.5 0 0 0-.708 0l-3 3a.5.5 0 0 0 0 .708l1 1a.5.5 0 0 0 .708 0L7 4.207V12H1a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1H9V4.207l.646.647a.5.5 0 0 0 .708 0l1-1a.5.5 0 0 0 0-.708z" />
                            <path
                              d="M1 7a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h4.5a.5.5 0 0 0 0-1H1V8h4.5a.5.5 0 0 0 0-1zm9.5 0a.5.5 0 0 0 0 1H15v2h-4.5a.5.5 0 0 0 0 1H15a1 1 0 0 0 1-1V8a1 1 0 0 0-1-1z" />
                          </svg>
                          立即备份
                        </button>
                      </div>
                    </div>
                    <div
                      class="d-flex flex-column flex-md-row p-4 gap-4 py-md-5 align-items-center justify-content-center"
                      style="height: 40vh; overflow: auto">
                      <div
                        class="list-group list-group-radio d-grid gap-2 border-0">
                        <div
                          class="position-relative"
                          v-for="(item, index) in backups">
                          <input
                            class="form-check-input position-absolute top-50 end-0 me-3 fs-5"
                            type="radio"
                            name="backupListGroup"
                            v-model="selectBackup"
                            :value="item"
                            :checked="index === 0"
                            :id="'backup_op_' +item.sha" />
                          <label
                            class="list-group-item py-3 pe-5"
                            :for="'backup_op_' +item.sha">
                            <strong class="fw-semibold">{{item.name}}</strong>
                            <span class="d-block small opacity-75"
                              >日期：{{parseFileName(item.name)}}，大小：{{sizeF(item.size)}}，<a
                                :href="item.download_url"
                                class="text-decoration-none link-success"
                                target="_blank"
                                >下载</a
                              ></span
                            >
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div
                    class="tab-pane fade"
                    id="pills-profile"
                    role="tabpanel"
                    aria-labelledby="pills-profile-tab"
                    tabindex="1">
                    <div class="alert alert-light" role="alert">
                      配置临时修改，重启后修改丢失，请根据你的使用场景导出<code>env.txt</code>或<code>config.yaml</code>，手动覆盖环境变量或配置文件
                    </div>
                    <div class="mb-3 row">
                      <label class="col-sm-2 col-form-label">应用名称</label>
                      <div class="col-sm-4">
                        <input
                          type="txt"
                          class="form-control"
                          v-model="config.bak_app_name" />
                      </div>
                      <label class="col-sm-2 col-form-label">网络代理</label>
                      <div class="col-sm-4">
                        <input
                          type="txt"
                          class="form-control"
                          v-model="config.bak_proxy" />
                      </div>
                    </div>
                    <div class="mb-3 row">
                      <label class="col-sm-2 col-form-label">备份仓库</label>
                      <div class="col-sm-4">
                        <input
                          type="txt"
                          class="form-control"
                          v-model="config.bak_repo" />
                      </div>
                      <label class="col-sm-2 col-form-label">仓库所有者</label>
                      <div class="col-sm-4">
                        <input
                          type="txt"
                          class="form-control"
                          v-model="config.bak_repo_owner" />
                      </div>
                    </div>
                    <div class="mb-3 row">
                      <label class="col-sm-2 col-form-label">分支</label>
                      <div class="col-sm-4">
                        <input
                          type="txt"
                          class="form-control"
                          v-model="config.bak_branch"
                          placeholder="main" />
                      </div>
                      <label class="col-sm-2 col-form-label">GitHub PAT</label>
                      <div class="col-sm-4">
                        <input
                          type="txt"
                          class="form-control"
                          v-model="config.bak_github_token" />
                      </div>
                    </div>
                    <div class="mb-3 row">
                      <label class="col-sm-2 col-form-label">备份目录</label>
                      <div class="col-sm-4">
                        <input
                          type="txt"
                          class="form-control"
                          v-model="config.bak_data_dir" />
                      </div>
                      <label class="col-sm-2 col-form-label">执行计划</label>
                      <div class="col-sm-4">
                        <input
                          type="txt"
                          class="form-control"
                          v-model="config.bak_cron" />
                      </div>
                    </div>
                    <div class="mb-3 row">
                      <label class="col-sm-2 col-form-label">延迟还原</label>
                      <div class="col-sm-4">
                        <div class="input-group mb-3">
                          <input
                            type="txt"
                            class="form-control"
                            v-model="config.bak_delay_restore"
                            placeholder="0" />
                          <span class="input-group-text">分钟</span>
                        </div>
                      </div>
                      <div class="col-sm-2 col-form-label">调试日志</div>
                      <div class="col-sm-4 d-flex align-items-center">
                        <div class="form-check form-switch">
                          <input
                            class="form-check-input"
                            id="isLog"
                            type="checkbox"
                            :checked="config.bak_log == '1'"
                            @change="changeLog" />
                        </div>
                      </div>
                    </div>
                    <div class="mb-3 row">
                      <label class="col-sm-2 col-form-label">运行模式</label>
                      <div class="col-sm-4 d-flex align-items-center">
                        <div class="form-check form-check-inline">
                          <input
                            class="form-check-input"
                            type="radio"
                            name="runModeOptions"
                            id="standalone"
                            :checked="config.run_mode == '1'"
                            @change="changeMode('1')" />
                          <label class="form-check-label" for="standalone"
                            >单独运行</label
                          >
                        </div>
                        <div class="form-check form-check-inline">
                          <input
                            class="form-check-input"
                            type="radio"
                            name="runModeOptions"
                            id="web"
                            :checked="config.run_mode == '2'"
                            @change="changeMode('2')" />
                          <label class="form-check-label" for="web">WEB</label>
                        </div>
                      </div>
                      <label class="col-sm-2 col-form-label">端口路径</label>
                      <div class="col-sm-2">
                        <input
                          type="txt"
                          class="form-control"
                          name="webPort"
                          placeholder="端口"
                          v-model="config.web_port" />
                      </div>
                      <div class="col-sm-2">
                        <input
                          type="txt"
                          class="form-control"
                          name="webPath"
                          placeholder="路径"
                          v-model="config.web_path" />
                      </div>
                    </div>
                    <div class="mb-3 row">
                      <label class="col-sm-2 col-form-label">网站密码</label>
                      <div class="col-sm-4">
                        <input
                          type="password"
                          class="form-control"
                          v-model="config.web_pwd" />
                      </div>
                      <div class="col-sm-6">
                        <div class="dropdown float-end">
                          <button
                            class="btn btn-secondary dropdown-toggle"
                            type="button"
                            data-bs-toggle="dropdown"
                            aria-expanded="false">
                            <svg
                              xmlns="http://www.w3.org/2000/svg"
                              width="16"
                              height="16"
                              fill="currentColor"
                              class="bi bi-download"
                              viewBox="0 0 16 16">
                              <path
                                d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5" />
                              <path
                                d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z" />
                            </svg>
                            导出
                          </button>
                          <ul class="dropdown-menu">
                            <li>
                              <a
                                class="dropdown-item"
                                href="javascript:void(0)"
                                @click="exportFile('1')"
                                >.env file</a
                              >
                            </li>
                            <li>
                              <a
                                class="dropdown-item"
                                href="javascript:void(0)"
                                @click="exportFile('2')"
                                >config.yaml</a
                              >
                            </li>
                          </ul>
                        </div>
                        <button
                          type="button"
                          class="btn btn-primary float-end rounded me-2"
                          @click="saveConfig()">
                          <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="16"
                            height="16"
                            fill="currentColor"
                            class="bi bi-save2"
                            viewBox="0 0 16 16">
                            <path
                              d="M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9.5a1 1 0 0 0-1 1v4.5h2a.5.5 0 0 1 .354.854l-2.5 2.5a.5.5 0 0 1-.708 0l-2.5-2.5A.5.5 0 0 1 5.5 6.5h2V2a2 2 0 0 1 2-2H14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h2.5a.5.5 0 0 1 0 1z" />
                          </svg>
                          保存
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <footer class="navbar-fixed-bottom" style="height: 5vh">
          <p class="text-center text-muted">
            © {{ currentYear }} Libs. Powered by
            <a
              href="https://github.com/laboratorys/backup2gh"
              class="text-decoration-none link-success"
              target="_blank"
              >backup2gh</a
            >
          </p>
        </footer>
      </div>
    </div>
  </body>
  <script src="https://unpkg.shop.jd.com/axios@1.7.9/dist/axios.min.js"></script>
  <script>
    const { createApp, ref } = Vue;
    createApp({
      setup() {
        const config = ref({});
        const backups = ref([]);
        const selectBackup = ref({});
        const currentYear = new Date().getFullYear();
        const getConfig = () => {
          return new Promise((resolve, reject) => {
            axios
              .get("<<.base_path>>/config")
              .then((res) => {
                resolve(res);
              })
              .catch((err) => {
                reject(err);
              });
          });
        };
        const getBackups = () => {
          return new Promise((resolve, reject) => {
            axios
              .get("<<.base_path>>/backups")
              .then((res) => {
                resolve(res);
              })
              .catch((err) => {
                reject(err);
              });
          });
        };
        const notify = (msg) => {
          const toastLiveExample = document.getElementById("liveToast");
          const toast = new bootstrap.Toast(toastLiveExample, { delay: 1000 });
          document.getElementById("msgId").innerHTML = msg;
          toast.show();
        };
        const saveConfig = () => {
          axios.post("<<.base_path>>/config", config.value).then((res) => {
            notify("😁 配置修改成功！");
          });
        };
        const changeMode = (v) => {
          config.value.run_mode = v;
        };
        const changeLog = () => {
          if (config.value.bak_log === "1") {
            config.value.bak_log = "0";
          } else {
            config.value.bak_log = "1";
          }
        };
        const sizeF = (value) => {
          let fileSizeByte = value;
          let fileSizeMsg = "";
          if (fileSizeByte < 1048576)
            fileSizeMsg = (fileSizeByte / 1024).toFixed(2) + " KB";
          else if (fileSizeByte === 1048576) fileSizeMsg = "1MB";
          else if (fileSizeByte > 1048576 && fileSizeByte < 1073741824)
            fileSizeMsg = (fileSizeByte / (1024 * 1024)).toFixed(2) + " MB";
          else if (fileSizeByte > 1048576 && fileSizeByte === 1073741824)
            fileSizeMsg = "1GB";
          else if (fileSizeByte > 1073741824 && fileSizeByte < 1099511627776)
            fileSizeMsg =
              (fileSizeByte / (1024 * 1024 * 1024)).toFixed(2) + " GB";
          else fileSizeMsg = "文件超过1TB";
          return fileSizeMsg;
        };
        const parseFileName = (filename) => {
          const year = filename.slice(0, 4);
          const month = filename.slice(4, 6);
          const day = filename.slice(6, 8);
          const hour = filename.slice(8, 10);
          const minute = filename.slice(10, 12);
          return `${year}/${month}/${day} ${hour}:${minute}`;
        };
        const deleteBackup = async() => {
          const result = await confirm();
          if(result){
            axios
              .post("<<.base_path>>/backup/delete", selectBackup.value)
              .then((res) => {
                getBackups().then((data) => {
                  backups.value = data.data;
                  if (data.data && data.data.length > 0) {
                    selectBackup.value = data.data[0];
                  }
                });
                notify("😁 备份删除成功！");
              })
              .catch((err) => {
                notify("🥹 备份删除失败！");
              });
          }
        };
        const restoreBackup = () => {
          axios
            .post("<<.base_path>>/backup/restore", selectBackup.value)
            .then((res) => {
              notify(`😁 备份:${selectBackup.value.name}还原成功！`);
            });
        };
        const runBackup = () => {
          axios.get("<<.base_path>>/backup/run").then((res) => {
            getBackups().then((data) => {
              backups.value = data.data;
              if (data.data && data.data.length > 0) {
                selectBackup.value = data.data[0];
              }
            });
            notify(`😁 备份上传中，请稍后查看备份结果！`);
          });
        };
        const exportFile = (type) => {
          window.location.href = `<<.base_path>>/config/export?type=${type}`;
        };
        const confirm = async() => {
          return await b_confirm('确认删除该备份吗？')
        };
        const  b_confirm = async(msg) =>{
          const modalElem = document.createElement('div')
          modalElem.id = "modal-confirm"
          modalElem.className = "modal"
          modalElem.innerHTML = `
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-body fs-6">
          <p>${msg}🤔</p>
      </div>    <!-- modal-body -->
      <div class="modal-footer" style="border-top:0px">
        <button id="modal-btn-aceptar" type="button" class="btn btn-primary">确认</button>
        <button id="modal-btn-descartar" type="button" class="btn btn-secondary">取消</button>
      </div>
    </div>
  </div>
  `
          const myModal = new bootstrap.Modal(modalElem, {
            keyboard: false,
            backdrop: 'static'
          })
          myModal.show()

          return new Promise((resolve, reject) => {
            document.body.addEventListener('click', response)

            function response(e) {
              let bool = false
              if (e.target.id == 'modal-btn-descartar') bool = false
              else if (e.target.id == 'modal-btn-aceptar') bool = true
              else return

              document.body.removeEventListener('click', response)
              document.body.querySelector('.modal-backdrop').remove()
              modalElem.remove()
              resolve(bool)
            }
          })
        };
        return {
          config,
          currentYear,
          backups,
          selectBackup,
          getConfig,
          saveConfig,
          changeMode,
          changeLog,
          getBackups,
          sizeF,
          parseFileName,
          deleteBackup,
          restoreBackup,
          runBackup,
          exportFile,
        };
      },
      async created() {
        let configResp = await this.getConfig();
        let backupResp = await this.getBackups();
        this.config = configResp.data;
        this.backups = backupResp.data.reverse();
        if (backupResp.data && backupResp.data.length > 0) {
          this.selectBackup = backupResp.data[0];
        }
      },
    }).mount("#app");
  </script>
</html>
